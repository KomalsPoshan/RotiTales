---
layout: home
title: Home
---

<!-- ====== FULL-SCREEN VIDEO CAROUSEL ====== -->
<div class="hero-carousel">

  <!-- Carousel viewport -->
  <div class="carousel-viewport">
    <div class="carousel-track" id="carousel-track">

      <!-- Slide 1: Ghee on Roti -->
      <div class="carousel-slide is-active" data-index="0" data-video-id="Q2SRAu9FiqQ">
        <div class="slide-card">
          <div class="slide-video slide-video-api">
            <div id="player-0"></div>
          </div>
          <div class="card-header">
            <h3 class="card-header-title">Ghee on Roti</h3>
            <div class="card-header-controls">
              <button class="card-ctrl ctrl-playpause" data-slide="0" aria-label="Play/Pause">
                <svg class="pp-pause" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg>
                <svg class="pp-play" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><polygon points="5,3 19,12 5,21"/></svg>
              </button>
              <button class="card-ctrl card-mute is-muted" data-slide="0" aria-label="Toggle sound">
                <svg class="sound-icon-muted" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 5L6 9H2v6h4l5 4V5z"/><line x1="23" y1="9" x2="17" y2="15"/><line x1="17" y1="9" x2="23" y2="15"/></svg>
                <svg class="sound-icon-on" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 5L6 9H2v6h4l5 4V5z"/><path d="M19.07 4.93a10 10 0 010 14.14"/><path d="M15.54 8.46a5 5 0 010 7.07"/></svg>
              </button>
            </div>
          </div>
          <div class="card-footer">
            <p class="card-footer-subtitle">Ghee on Roti</p>
            <span class="card-footer-brand">Roti Tales</span>
          </div>
        </div>
      </div>

      <!-- Slide 2: Fiber thru Roti -->
      <div class="carousel-slide" data-index="1" data-video-id="k1Tt-mMHyd0">
        <div class="slide-card">
          <div class="slide-video slide-video-api">
            <div id="player-1"></div>
          </div>
          <div class="card-header">
            <h3 class="card-header-title">Fiber thru Roti</h3>
            <div class="card-header-controls">
              <button class="card-ctrl ctrl-playpause" data-slide="1" aria-label="Play/Pause">
                <svg class="pp-pause" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg>
                <svg class="pp-play" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><polygon points="5,3 19,12 5,21"/></svg>
              </button>
              <button class="card-ctrl card-mute is-muted" data-slide="1" aria-label="Toggle sound">
                <svg class="sound-icon-muted" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 5L6 9H2v6h4l5 4V5z"/><line x1="23" y1="9" x2="17" y2="15"/><line x1="17" y1="9" x2="23" y2="15"/></svg>
                <svg class="sound-icon-on" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 5L6 9H2v6h4l5 4V5z"/><path d="M19.07 4.93a10 10 0 010 14.14"/><path d="M15.54 8.46a5 5 0 010 7.07"/></svg>
              </button>
            </div>
          </div>
          <div class="card-footer">
            <p class="card-footer-subtitle">Fiber thru Roti</p>
            <span class="card-footer-brand">Roti Tales</span>
          </div>
        </div>
      </div>

      <!-- Slide 3: Roti's Gluten -->
      <div class="carousel-slide" data-index="2" data-video-id="tLSUnNDu1kM">
        <div class="slide-card">
          <div class="slide-video slide-video-api">
            <div id="player-2"></div>
          </div>
          <div class="card-header">
            <h3 class="card-header-title">Roti's Gluten</h3>
            <div class="card-header-controls">
              <button class="card-ctrl ctrl-playpause" data-slide="2" aria-label="Play/Pause">
                <svg class="pp-pause" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg>
                <svg class="pp-play" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><polygon points="5,3 19,12 5,21"/></svg>
              </button>
              <button class="card-ctrl card-mute is-muted" data-slide="2" aria-label="Toggle sound">
                <svg class="sound-icon-muted" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 5L6 9H2v6h4l5 4V5z"/><line x1="23" y1="9" x2="17" y2="15"/><line x1="17" y1="9" x2="23" y2="15"/></svg>
                <svg class="sound-icon-on" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 5L6 9H2v6h4l5 4V5z"/><path d="M19.07 4.93a10 10 0 010 14.14"/><path d="M15.54 8.46a5 5 0 010 7.07"/></svg>
              </button>
            </div>
          </div>
          <div class="card-footer">
            <p class="card-footer-subtitle">Roti's Gluten</p>
            <span class="card-footer-brand">Roti Tales</span>
          </div>
        </div>
      </div>

      <!-- Slide 4: Taco with Rotis -->
      <div class="carousel-slide" data-index="3" data-video-id="45Cvzh2U818">
        <div class="slide-card">
          <div class="slide-video slide-video-api">
            <div id="player-3"></div>
          </div>
          <div class="card-header">
            <h3 class="card-header-title">Taco with Rotis</h3>
            <div class="card-header-controls">
              <button class="card-ctrl ctrl-playpause" data-slide="3" aria-label="Play/Pause">
                <svg class="pp-pause" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg>
                <svg class="pp-play" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><polygon points="5,3 19,12 5,21"/></svg>
              </button>
              <button class="card-ctrl card-mute is-muted" data-slide="3" aria-label="Toggle sound">
                <svg class="sound-icon-muted" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 5L6 9H2v6h4l5 4V5z"/><line x1="23" y1="9" x2="17" y2="15"/><line x1="17" y1="9" x2="23" y2="15"/></svg>
                <svg class="sound-icon-on" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 5L6 9H2v6h4l5 4V5z"/><path d="M19.07 4.93a10 10 0 010 14.14"/><path d="M15.54 8.46a5 5 0 010 7.07"/></svg>
              </button>
            </div>
          </div>
          <div class="card-footer">
            <p class="card-footer-subtitle">Taco with Rotis</p>
            <span class="card-footer-brand">Roti Tales</span>
          </div>
        </div>
      </div>

      <!-- Slide 5: Connect card -->
      <div class="carousel-slide" data-index="4">
        <div class="slide-card">
          <div class="slide-connect">
            <div class="connect-bg-anim"></div>
            <img src="/assets/images/rotitales_roti_on_fire_logo.png" alt="Roti Tales" class="connect-logo" />
            <h3 class="connect-title">Join the Family</h3>
            <p class="connect-desc">More roti goodness awaits</p>
            <div class="connect-grid">
              <a href="https://www.youtube.com/@rotitales" class="connect-link">
                <img src="/assets/icons/youtube-clay.svg" alt="YouTube" />
                <span>YouTube</span>
              </a>
              <a href="https://instagram.com/rotitales" class="connect-link">
                <img src="/assets/icons/instagram-clay.svg" alt="Instagram" />
                <span>Instagram</span>
              </a>
              <a href="https://www.facebook.com/rotitales" class="connect-link">
                <img src="/assets/icons/facebook-clay.svg" alt="Facebook" />
                <span>Facebook</span>
              </a>
              <a href="https://www.linkedin.com/showcase/rotitales" class="connect-link">
                <img src="/assets/icons/linkedin-clay.svg" alt="LinkedIn" />
                <span>LinkedIn</span>
              </a>
            </div>
          </div>
        </div>
      </div>

      <!-- Slide 6: Wheat Variety -->
      <div class="carousel-slide" data-index="5" data-video-id="TvMdYHopJNg">
        <div class="slide-card">
          <div class="slide-video slide-video-api">
            <div id="player-5"></div>
          </div>
          <div class="card-header">
            <h3 class="card-header-title">Wheat Variety</h3>
            <div class="card-header-controls">
              <button class="card-ctrl ctrl-playpause" data-slide="5" aria-label="Play/Pause">
                <svg class="pp-pause" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg>
                <svg class="pp-play" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><polygon points="5,3 19,12 5,21"/></svg>
              </button>
              <button class="card-ctrl card-mute is-muted" data-slide="5" aria-label="Toggle sound">
                <svg class="sound-icon-muted" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 5L6 9H2v6h4l5 4V5z"/><line x1="23" y1="9" x2="17" y2="15"/><line x1="17" y1="9" x2="23" y2="15"/></svg>
                <svg class="sound-icon-on" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 5L6 9H2v6h4l5 4V5z"/><path d="M19.07 4.93a10 10 0 010 14.14"/><path d="M15.54 8.46a5 5 0 010 7.07"/></svg>
              </button>
            </div>
          </div>
          <div class="card-footer">
            <p class="card-footer-subtitle">Wheat Variety</p>
            <span class="card-footer-brand">Roti Tales</span>
          </div>
        </div>
      </div>

      <!-- Slide 7: Packaged Tortillas -->
      <div class="carousel-slide" data-index="6" data-video-id="UmADIP7Eneo">
        <div class="slide-card">
          <div class="slide-video slide-video-api">
            <div id="player-6"></div>
          </div>
          <div class="card-header">
            <h3 class="card-header-title">Packaged Tortillas</h3>
            <div class="card-header-controls">
              <button class="card-ctrl ctrl-playpause" data-slide="6" aria-label="Play/Pause">
                <svg class="pp-pause" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg>
                <svg class="pp-play" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><polygon points="5,3 19,12 5,21"/></svg>
              </button>
              <button class="card-ctrl card-mute is-muted" data-slide="6" aria-label="Toggle sound">
                <svg class="sound-icon-muted" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 5L6 9H2v6h4l5 4V5z"/><line x1="23" y1="9" x2="17" y2="15"/><line x1="17" y1="9" x2="23" y2="15"/></svg>
                <svg class="sound-icon-on" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 5L6 9H2v6h4l5 4V5z"/><path d="M19.07 4.93a10 10 0 010 14.14"/><path d="M15.54 8.46a5 5 0 010 7.07"/></svg>
              </button>
            </div>
          </div>
          <div class="card-footer">
            <p class="card-footer-subtitle">Packaged Tortillas</p>
            <span class="card-footer-brand">Roti Tales</span>
          </div>
        </div>
      </div>

      <!-- Slide 8: Dough Quality -->
      <div class="carousel-slide" data-index="7" data-video-id="bKHeCYNw9bY">
        <div class="slide-card">
          <div class="slide-video slide-video-api">
            <div id="player-7"></div>
          </div>
          <div class="card-header">
            <h3 class="card-header-title">Dough Quality</h3>
            <div class="card-header-controls">
              <button class="card-ctrl ctrl-playpause" data-slide="7" aria-label="Play/Pause">
                <svg class="pp-pause" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg>
                <svg class="pp-play" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><polygon points="5,3 19,12 5,21"/></svg>
              </button>
              <button class="card-ctrl card-mute is-muted" data-slide="7" aria-label="Toggle sound">
                <svg class="sound-icon-muted" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 5L6 9H2v6h4l5 4V5z"/><line x1="23" y1="9" x2="17" y2="15"/><line x1="17" y1="9" x2="23" y2="15"/></svg>
                <svg class="sound-icon-on" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 5L6 9H2v6h4l5 4V5z"/><path d="M19.07 4.93a10 10 0 010 14.14"/><path d="M15.54 8.46a5 5 0 010 7.07"/></svg>
              </button>
            </div>
          </div>
          <div class="card-footer">
            <p class="card-footer-subtitle">Dough Quality</p>
            <span class="card-footer-brand">Roti Tales</span>
          </div>
        </div>
      </div>

      <!-- Slide 9: Roti or Preservatives -->
      <div class="carousel-slide" data-index="8" data-video-id="oQPZyqFDFJc">
        <div class="slide-card">
          <div class="slide-video slide-video-api">
            <div id="player-8"></div>
          </div>
          <div class="card-header">
            <h3 class="card-header-title">Roti or Preservatives</h3>
            <div class="card-header-controls">
              <button class="card-ctrl ctrl-playpause" data-slide="8" aria-label="Play/Pause">
                <svg class="pp-pause" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg>
                <svg class="pp-play" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><polygon points="5,3 19,12 5,21"/></svg>
              </button>
              <button class="card-ctrl card-mute is-muted" data-slide="8" aria-label="Toggle sound">
                <svg class="sound-icon-muted" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 5L6 9H2v6h4l5 4V5z"/><line x1="23" y1="9" x2="17" y2="15"/><line x1="17" y1="9" x2="23" y2="15"/></svg>
                <svg class="sound-icon-on" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 5L6 9H2v6h4l5 4V5z"/><path d="M19.07 4.93a10 10 0 010 14.14"/><path d="M15.54 8.46a5 5 0 010 7.07"/></svg>
              </button>
            </div>
          </div>
          <div class="card-footer">
            <p class="card-footer-subtitle">Roti or Preservatives</p>
            <span class="card-footer-brand">Roti Tales</span>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- Controls — bottom center -->
  <div class="hero-controls">
    <button class="ctrl-btn" id="ctrl-prev" aria-label="Previous">
      <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg>
    </button>

    <div class="hero-dots" id="hero-dots">
      <span class="dot active" data-slide="0"></span>
      <span class="dot" data-slide="1"></span>
      <span class="dot" data-slide="2"></span>
      <span class="dot" data-slide="3"></span>
      <span class="dot" data-slide="4"></span>
      <span class="dot" data-slide="5"></span>
      <span class="dot" data-slide="6"></span>
      <span class="dot" data-slide="7"></span>
      <span class="dot" data-slide="8"></span>
    </div>

    <button class="ctrl-btn" id="ctrl-next" aria-label="Next">
      <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"/></svg>
    </button>
  </div>

</div>

<!-- ====== OUR MISSION ====== -->
<div class="mission-section">
  <div class="mission-inner">
    <img src="/assets/images/Poshan_Logo_2Color-Flour.png" alt="Poshan" class="mission-logo" />
    <h2 class="mission-title">Healthier Rotis, Happier Families</h2>
    <p class="mission-text">Roti Tales is a Poshan initiative empowering families with simple ways to make everyday rotis more nutritious — one recipe at a time.</p>
    <a class="mission-cta platform-trigger" href="#">
      Follow RotiTales
      <span class="mission-cta-arrow">&#8594;</span>
    </a>
  </div>
</div>

<!-- ====== PLATFORM CHOOSER POPUP ====== -->
<div class="platform-overlay" id="platform-popup">
  <div class="platform-modal">
    <button class="platform-close" id="platform-close" type="button">&times;</button>
    <div class="platform-header">
      <img src="/assets/images/rotitales_roti_on_fire_logo.png" alt="Roti Tales" class="platform-logo" />
      <div class="platform-brand">
        <h3 class="platform-heading">Roti Tales</h3>
        <p class="platform-tagline">Follow to keep eating healthy rotis!</p>
      </div>
    </div>
    <div class="platform-row">
      <a href="https://instagram.com/rotitales" class="platform-option">
        <img src="/assets/icons/instagram-clay.svg" alt="Instagram" />
        <span>Instagram</span>
      </a>
      <a href="https://www.youtube.com/@rotitales" class="platform-option">
        <img src="/assets/icons/youtube-clay.svg" alt="YouTube" />
        <span>YouTube</span>
      </a>
      <a href="https://www.facebook.com/rotitales" class="platform-option">
        <img src="/assets/icons/facebook-clay.svg" alt="Facebook" />
        <span>Facebook</span>
      </a>
      <a href="https://www.linkedin.com/showcase/rotitales" class="platform-option">
        <img src="/assets/icons/linkedin-clay.svg" alt="LinkedIn" />
        <span>LinkedIn</span>
      </a>
    </div>
  </div>
</div>

<!-- ====== FOLLOW NUDGE (appears after 5s) ====== -->
<div class="follow-nudge" id="follow-nudge">
  <svg class="follow-nudge-hand" viewBox="0 0 24 24" width="28" height="28" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
    <path d="M18 11V6a2 2 0 00-4 0v1"/>
    <path d="M14 10V4a2 2 0 00-4 0v6"/>
    <path d="M10 10.5V6a2 2 0 00-4 0v8"/>
    <path d="M18 11a2 2 0 014 0v3a8 8 0 01-8 8h-2c-2.5 0-4.5-1-6.2-2.8L3 16.4a2 2 0 013-2.6l.6.6"/>
  </svg>
  <span class="follow-nudge-text">Follow us!</span>
</div>

<!-- YouTube IFrame API -->
<script>
var tag = document.createElement('script');
tag.src = "https://www.youtube.com/iframe_api";
var firstScriptTag = document.getElementsByTagName('script')[0];
firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

var players = {};
var globalMuted = true;
var currentSlide = 0;
var slidePlaying = {};  // per-slide play state

function onYouTubeIframeAPIReady() {
  var videoSlides = document.querySelectorAll('.carousel-slide[data-video-id]');
  videoSlides.forEach(function(slide) {
    var idx = parseInt(slide.getAttribute('data-index'));
    var videoId = slide.getAttribute('data-video-id');
    var isFirst = (idx === 0);

    players[idx] = new YT.Player('player-' + idx, {
      videoId: videoId,
      playerVars: {
        autoplay: isFirst ? 1 : 0,
        mute: 1,
        controls: 0,
        showinfo: 0,
        rel: 0,
        loop: 1,
        playlist: videoId,
        modestbranding: 1,
        iv_load_policy: 3,
        disablekb: 1,
        fs: 0,
        playsinline: 1
      },
      events: {
        onReady: function(e) {
          if (isFirst) {
            e.target.playVideo();
            slidePlaying[idx] = true;
          }
        },
        onStateChange: function(e) {
          if (e.data === YT.PlayerState.ENDED) {
            players[idx].playVideo();
          }
        }
      }
    });

    slidePlaying[idx] = isFirst;
  });
}

// ===== Carousel =====
(function() {
  var track = document.getElementById('carousel-track');
  var dots = document.querySelectorAll('#hero-dots .dot');
  var totalSlides = dots.length;
  var slides = document.querySelectorAll('.carousel-slide');

  function syncControls(idx) {
    slides.forEach(function(s) {
      var sIdx = parseInt(s.getAttribute('data-index'));
      var ppBtn = s.querySelector('.ctrl-playpause');
      var muteBtn = s.querySelector('.card-mute');
      if (ppBtn) {
        ppBtn.classList.toggle('is-paused', !slidePlaying[sIdx]);
      }
      if (muteBtn) {
        muteBtn.classList.toggle('is-muted', globalMuted);
      }
    });
  }

  function goTo(idx) {
    if (idx < 0) idx = totalSlides - 1;
    if (idx >= totalSlides) idx = 0;

    var prevSlide = currentSlide;
    currentSlide = idx;

    var slidePct = parseFloat(getComputedStyle(document.body).getPropertyValue('--slide-pct')) || 70;
    var offset = (100 - slidePct) / 2;
    track.style.transform = 'translateX(' + (offset - currentSlide * slidePct) + '%)';

    dots.forEach(function(d, i) { d.classList.toggle('active', i === currentSlide); });
    slides.forEach(function(s, i) { s.classList.toggle('is-active', i === currentSlide); });

    // Pause previous video
    if (players[prevSlide] && players[prevSlide].pauseVideo) {
      try { players[prevSlide].pauseVideo(); } catch(e) {}
    }

    // Play new video (if it's a video slide)
    if (players[currentSlide] && players[currentSlide].playVideo) {
      try {
        if (globalMuted) { players[currentSlide].mute(); } else { players[currentSlide].unMute(); }
        players[currentSlide].playVideo();
        slidePlaying[currentSlide] = true;
      } catch(e) {}
    }

    syncControls(currentSlide);
  }

  goTo(0);

  document.getElementById('ctrl-prev').addEventListener('click', function() { goTo(currentSlide - 1); });
  document.getElementById('ctrl-next').addEventListener('click', function() { goTo(currentSlide + 1); });

  dots.forEach(function(dot) {
    dot.addEventListener('click', function() {
      goTo(parseInt(this.getAttribute('data-slide')));
    });
  });

  // Swipe support
  var startX = 0;
  var viewport = document.querySelector('.carousel-viewport');
  viewport.addEventListener('touchstart', function(e) { startX = e.touches[0].clientX; }, { passive: true });
  viewport.addEventListener('touchend', function(e) {
    var diff = startX - e.changedTouches[0].clientX;
    if (Math.abs(diff) > 50) {
      goTo(diff > 0 ? currentSlide + 1 : currentSlide - 1);
    }
  });

  // Keyboard arrows
  document.addEventListener('keydown', function(e) {
    if (e.key === 'ArrowRight') goTo(currentSlide + 1);
    if (e.key === 'ArrowLeft') goTo(currentSlide - 1);
  });

  // ===== Per-slide play/pause and mute =====
  document.querySelectorAll('.ctrl-playpause').forEach(function(btn) {
    btn.addEventListener('click', function() {
      var idx = parseInt(this.getAttribute('data-slide'));
      var p = players[idx];
      if (!p || !p.getPlayerState) return;
      var state = p.getPlayerState();
      if (state === YT.PlayerState.PLAYING) {
        p.pauseVideo();
        slidePlaying[idx] = false;
        this.classList.add('is-paused');
      } else {
        p.playVideo();
        slidePlaying[idx] = true;
        this.classList.remove('is-paused');
      }
    });
  });

  document.querySelectorAll('.card-mute').forEach(function(btn) {
    btn.addEventListener('click', function() {
      var idx = parseInt(this.getAttribute('data-slide'));
      var p = players[idx];
      if (!p || !p.isMuted) return;
      if (p.isMuted()) {
        p.unMute();
        globalMuted = false;
      } else {
        p.mute();
        globalMuted = true;
      }
      // Sync all mute buttons
      document.querySelectorAll('.card-mute').forEach(function(m) {
        m.classList.toggle('is-muted', globalMuted);
      });
    });
  });

  // Expose goTo for external use
  window._carouselGoTo = goTo;
})();

// ===== Platform chooser popup =====
(function() {
  var popup = document.getElementById('platform-popup');
  var closeBtn = document.getElementById('platform-close');
  if (!popup) return;

  function openPopup() {
    popup.classList.add('is-open');
  }
  function closePopup() {
    popup.classList.remove('is-open');
  }

  document.querySelectorAll('.platform-trigger').forEach(function(el) {
    el.addEventListener('click', function(e) {
      e.preventDefault();
      e.stopPropagation();
      openPopup();
    });
  });

  if (closeBtn) closeBtn.addEventListener('click', closePopup);
  popup.addEventListener('click', function(e) { if (e.target === popup) closePopup(); });
  document.addEventListener('keydown', function(e) { if (e.key === 'Escape') closePopup(); });
  window._openPlatformPopup = openPopup;
})();

// ===== Follow nudge =====
(function() {
  var nudge = document.getElementById('follow-nudge');
  if (!nudge) return;
  nudge.addEventListener('click', function() {
    if (window._openPlatformPopup) window._openPlatformPopup();
  });
})();
</script>
